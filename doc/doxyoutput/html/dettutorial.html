<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>mlpack: Density Estimation Tree (DET) tutorial</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extra-stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">mlpack
   &#160;<span id="projectnumber">3.4.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Density Estimation Tree (DET) tutorial </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="intro_det_tut"></a>
Introduction</h1>
<p>DETs perform the unsupervised task of density estimation using decision trees. Using a trained density estimation tree (DET), the density at any particular point can be estimated very quickly (O(log n) time, where n is the number of points the tree is built on).</p>
<p>The details of this work is presented in the following paper: </p><div class="fragment"><div class="line">@inproceedings{ram2011density,</div>
<div class="line">  title={Density estimation trees},</div>
<div class="line">  author={Ram, P. and Gray, A.G.},</div>
<div class="line">  booktitle={Proceedings of the 17th ACM SIGKDD International Conference on</div>
<div class="line">      Knowledge Discovery and Data Mining},</div>
<div class="line">  pages={627--635},</div>
<div class="line">  year={2011},</div>
<div class="line">  organization={ACM}</div>
<div class="line">}</div>
</div><!-- fragment --><p><b>mlpack</b> provides:</p>
<ul>
<li>a <a class="el" href="dettutorial.html#cli_det_tut">simple command-line executable</a> to perform density estimation and related analyses using DETs</li>
<li>a <a class="el" href="dettutorial.html#dtree_det_tut">generic C++ class (DTree)</a> which provides various functionality for the DETs</li>
<li>a set of functions in the namespace <a class="el" href="dettutorial.html#dtutils_det_tut">mlpack::det</a> to perform cross-validation for the task of density estimation with DETs</li>
</ul>
<h1><a class="anchor" id="toc_det_tut"></a>
Table of Contents</h1>
<p>A list of all the sections this tutorial contains.</p>
<ul>
<li><a class="el" href="dettutorial.html#intro_det_tut">Introduction</a></li>
<li><a class="el" href="dettutorial.html#toc_det_tut">Table of Contents</a></li>
<li><a class="el" href="dettutorial.html#cli_det_tut">Command-Line mlpack_det</a><ul>
<li><a class="el" href="dettutorial.html#cli_ex1_de_tut">Plain-vanilla density estimation</a></li>
<li><a class="el" href="dettutorial.html#cli_ex2_de_test_tut">Estimation on a test set</a></li>
<li><a class="el" href="dettutorial.html#cli_ex4_de_vi_tut">Computing the variable importance</a></li>
<li><a class="el" href="dettutorial.html#cli_ex6_de_save">Saving trained DETs</a></li>
<li><a class="el" href="dettutorial.html#cli_ex7_de_load">Loading trained DETs</a></li>
</ul>
</li>
<li><a class="el" href="dettutorial.html#dtree_det_tut">The 'DTree' class</a><ul>
<li><a class="el" href="dettutorial.html#dtree_pub_func_det_tut">Public Functions</a></li>
</ul>
</li>
<li><a class="el" href="dettutorial.html#dtutils_det_tut">'namespace mlpack::det'</a><ul>
<li><a class="el" href="dettutorial.html#dtutils_util_funcs">Utility Functions</a></li>
</ul>
</li>
<li><a class="el" href="dettutorial.html#further_doc_det_tut">Further Documentation</a></li>
</ul>
<h1><a class="anchor" id="cli_det_tut"></a>
Command-Line mlpack_det</h1>
<p>The command line arguments of this program can be viewed using the <code>-h</code> option:</p>
<div class="fragment"><div class="line">$ mlpack_det -h</div>
<div class="line">Density Estimation With Density Estimation Trees</div>
<div class="line"> </div>
<div class="line">  This program performs a number of functions related to Density Estimation</div>
<div class="line">  Trees.  The optimal Density Estimation Tree (DET) can be trained on a <a class="code" href="bindings_2cli_2CMakeLists_8txt.html#a6cb7600e385afaebaa9cd3321e336597">set</a> of</div>
<div class="line">  data (specified by --training_file or -t) <span class="keyword">using</span> cross-validation (with number</div>
<div class="line">  of folds specified by --folds).  This trained density estimation tree may then</div>
<div class="line">  be saved to a model file with the --output_model_file (-M) option.</div>
<div class="line"> </div>
<div class="line">  The variable importances of each dimension may be saved with the --vi_file</div>
<div class="line">  (-i) option, and the density estimates on each training point may be saved to</div>
<div class="line">  the file specified with the --training_set_estimates_file (-e) option.</div>
<div class="line"> </div>
<div class="line">  This program also can provide density estimates <span class="keywordflow">for</span> a <a class="code" href="bindings_2cli_2CMakeLists_8txt.html#a6cb7600e385afaebaa9cd3321e336597">set</a> of test points,</div>
<div class="line">  specified in the --test_file (-T) file.  The density estimation tree used <span class="keywordflow">for</span></div>
<div class="line">  <span class="keyword">this</span> task will be the tree that was trained on the given training points, or a</div>
<div class="line">  tree stored in the file given with the --input_model_file (-m) parameter.  The</div>
<div class="line">  density estimates <span class="keywordflow">for</span> the test points may be saved into the file specified</div>
<div class="line">  with the --test_set_estimates_file (-E) option.</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">Options:</div>
<div class="line"> </div>
<div class="line">  --folds (-f) [int]            The number of folds of cross-validation to</div>
<div class="line">                                perform <span class="keywordflow">for</span> the estimation (0 is LOOCV)  Default</div>
<div class="line">                                value 10.</div>
<div class="line">  --help (-h)                   Default help info.</div>
<div class="line">  --info [string]               Get help on a specific module or option.</div>
<div class="line">                                Default value <span class="stringliteral">&#39;&#39;</span>.</div>
<div class="line">  --input_model_file (-m) [string]</div>
<div class="line">                                File containing already trained density</div>
<div class="line">                                estimation tree.  Default value <span class="stringliteral">&#39;&#39;</span>.</div>
<div class="line">  --max_leaf_size (-L) [int]    The maximum size of a leaf in the unpruned,</div>
<div class="line">                                fully grown DET.  Default value 10.</div>
<div class="line">  --min_leaf_size (-l) [int]    The minimum size of a leaf in the unpruned,</div>
<div class="line">                                fully grown DET.  Default value 5.</div>
<div class="line">  --output_model_file (-M) [string]</div>
<div class="line">                                File to save trained density estimation tree to.</div>
<div class="line">                                 Default value <span class="stringliteral">&#39;&#39;</span>.</div>
<div class="line">  --test_file (-T) [string]     A <a class="code" href="bindings_2cli_2CMakeLists_8txt.html#a6cb7600e385afaebaa9cd3321e336597">set</a> of test points to estimate the density of.</div>
<div class="line">                                 Default value <span class="stringliteral">&#39;&#39;</span>.</div>
<div class="line">  --test_set_estimates_file (-E) [string]</div>
<div class="line">                                The file in which to output the estimates on the</div>
<div class="line">                                test <a class="code" href="bindings_2cli_2CMakeLists_8txt.html#a6cb7600e385afaebaa9cd3321e336597">set</a> from the <span class="keyword">final</span> optimally pruned tree.</div>
<div class="line">                                Default value <span class="stringliteral">&#39;&#39;</span>.</div>
<div class="line">  --training_file (-t) [string]</div>
<div class="line">                                The data <a class="code" href="bindings_2cli_2CMakeLists_8txt.html#a6cb7600e385afaebaa9cd3321e336597">set</a> on which to build a density</div>
<div class="line">                                estimation tree.  Default value <span class="stringliteral">&#39;&#39;</span>.</div>
<div class="line">  --training_set_estimates_file (-e) [string]</div>
<div class="line">                                The file in which to output the density</div>
<div class="line">                                estimates on the training <a class="code" href="bindings_2cli_2CMakeLists_8txt.html#a6cb7600e385afaebaa9cd3321e336597">set</a> from the <span class="keyword">final</span></div>
<div class="line">                                optimally pruned tree.  Default value <span class="stringliteral">&#39;&#39;</span>.</div>
<div class="line">  --verbose (-v)                Display informational messages and the full list</div>
<div class="line">                                of parameters and timers at the end of</div>
<div class="line">                                execution.</div>
<div class="line">  --version (-V)                Display the version of <a class="code" href="namespacemlpack.html">mlpack</a>.</div>
<div class="line">  --vi_file (-i) [string]       The file to output the variable importance</div>
<div class="line">                                values <span class="keywordflow">for each</span> feature.  Default value <span class="stringliteral">&#39;&#39;</span>.</div>
<div class="line"> </div>
<div class="line">For further information, including relevant papers, citations, and theory,</div>
<div class="line">consult the documentation found at http:<span class="comment">//www.mlpack.org or included with your</span></div>
<div class="line">distribution of <a class="code" href="namespacemlpack.html">mlpack</a>.</div>
<div class="ttc" id="abindings_2cli_2CMakeLists_8txt_html_a6cb7600e385afaebaa9cd3321e336597"><div class="ttname"><a href="bindings_2cli_2CMakeLists_8txt.html#a6cb7600e385afaebaa9cd3321e336597">set</a></div><div class="ttdeci">set(SOURCES add_to_cli11.hpp cli_option.hpp default_param.hpp default_param_impl.hpp delete_allocated_memory.hpp end_program.hpp get_allocated_memory.hpp get_param.hpp get_raw_param.hpp get_printable_param.hpp get_printable_param_impl.hpp get_printable_param_name.hpp get_printable_param_name_impl.hpp get_printable_param_value.hpp get_printable_param_value_impl.hpp in_place_copy.hpp map_parameter_name.hpp output_param.hpp output_param_impl.hpp parameter_type.hpp parse_command_line.hpp print_doc_functions.hpp print_doc_functions_impl.hpp print_help.hpp print_help.cpp print_type_doc.hpp print_type_doc_impl.hpp set_param.hpp string_type_param.hpp string_type_param_impl.hpp) set(DIR_SRCS) foreach(file $</div><div class="ttdef"><b>Definition:</b> <a href="bindings_2cli_2CMakeLists_8txt_source.html#l00003">CMakeLists.txt:3</a></div></div>
<div class="ttc" id="anamespacemlpack_html"><div class="ttname"><a href="namespacemlpack.html">mlpack</a></div><div class="ttdoc">Linear algebra utility functions, generally performed on matrices or vectors.</div><div class="ttdef"><b>Definition:</b> <a href="add__to__cli11_8hpp_source.html#l00021">add_to_cli11.hpp:21</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="cli_ex1_de_tut"></a>
Plain-vanilla density estimation</h2>
<p>We can just train a DET on the provided data set <em>S</em>. Like all datasets <b>mlpack</b> uses, the data should be row-major (<b>mlpack</b> transposes data when it is loaded; internally, the data is column-major &ndash; see <a class="el" href="matrices.html">this page</a> for more information).</p>
<div class="fragment"><div class="line">$ mlpack_det -t dataset.csv -v</div>
</div><!-- fragment --><p>By default, <code>mlpack_det</code> performs 10-fold cross-validation (using the <img class="formulaInl" alt="$\alpha$" src="form_190.png"/>-pruning regularization for decision trees). To perform LOOCV (leave-one-out cross-validation), which can provide better results but will take longer, use the following command:</p>
<div class="fragment"><div class="line">$ mlpack_det -t dataset.csv -f 0 -v</div>
</div><!-- fragment --><p>To perform k-fold crossvalidation, use <code>-f</code> <code>k</code> (or <code>&ndash;folds</code> <code>k</code>). There are certain other options available for training. For example, in the construction of the initial tree, you can specify the maximum and minimum leaf sizes. By default, they are 10 and 5 respectively; you can set them using the <code>-M</code> (<code>&ndash;max_leaf_size</code>) and the <code>-N</code> (<code>&ndash;min_leaf_size</code>) options.</p>
<div class="fragment"><div class="line">$ mlpack_det -t dataset.csv -M 20 -N 10</div>
</div><!-- fragment --><p>In case you want to output the density estimates at the points in the training set, use the <code>-e</code> (<code>&ndash;training_set_estimates_file</code>) option to specify the output file to which the estimates will be saved. The first line in density_estimates.txt will correspond to the density at the first point in the training set. Note that the logarithm of the density estimates are given, which allows smaller estimates to be saved.</p>
<div class="fragment"><div class="line">$ mlpack_det -t dataset.csv -e density_estimates.txt -v</div>
</div><!-- fragment --><h2><a class="anchor" id="cli_ex2_de_test_tut"></a>
Estimation on a test set</h2>
<p>Often, it is useful to train a density estimation tree on a training set and then obtain density estimates from the learned estimator for a separate set of test points. The <code>-T</code> (<code>&ndash;test_file</code>) option allows specification of a set of test points, and the <code>-E</code> (<code>&ndash;test_set_estimates_file</code>) option allows specification of the file into which the test set estimates are saved. Note that the logarithm of the density estimates are saved; this allows smaller values to be saved.</p>
<div class="fragment"><div class="line">$ mlpack_det -t dataset.csv -T test_points.csv -E test_density_estimates.txt -v</div>
</div><!-- fragment --><h2><a class="anchor" id="cli_ex4_de_vi_tut"></a>
Computing the variable importance</h2>
<p>The variable importance (with respect to density estimation) of the different features in the data set can be obtained by using the <code>-i</code> (<code>&ndash;vi_file</code> ) option. This outputs the absolute (as opposed to relative) variable importance of the all the features into the specified file.</p>
<div class="fragment"><div class="line">$ mlpack_det -t dataset.csv -i variable_importance.txt -v</div>
</div><!-- fragment --><h2><a class="anchor" id="cli_ex6_de_save"></a>
Saving trained DETs</h2>
<p>The <code>mlpack_det</code> program is capable of saving a trained DET to a file for later usage. The <code>&ndash;output_model_file</code> or <code>-M</code> option allows specification of the file to save to. In the example below, a DET trained on <code>dataset.csv</code> is saved to the file <code>det.xml</code>.</p>
<div class="fragment"><div class="line">$ mlpack_det -t dataset.csv -M det.xml -v</div>
</div><!-- fragment --><h2><a class="anchor" id="cli_ex7_de_load"></a>
Loading trained DETs</h2>
<p>A saved DET can be used to perform any of the functionality in the examples above. A saved DET is loaded with the <code>&ndash;input_model_file</code> or <code>-m</code> option. The example below loads a saved DET from <code>det.xml</code> and outputs density estimates on the dataset <code>test_dataset.csv</code> into the file <code>estimates.csv</code>.</p>
<div class="fragment"><div class="line">$ mlpack_det -m det.xml -T test_dataset.csv -E estimates.csv -v</div>
</div><!-- fragment --><h1><a class="anchor" id="dtree_det_tut"></a>
The 'DTree' class</h1>
<p>This class implements density estimation trees. Below is a simple example which initializes a density estimation tree.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="dtree_8hpp.html">mlpack/methods/det/dtree.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacemlpack_1_1det.html">mlpack::det</a>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// The dataset matrix, on which to learn the density estimation tree.</span></div>
<div class="line"><span class="keyword">extern</span> arma::Mat&lt;float&gt; data;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Initialize the tree.  This function also creates and saves the bounding box</span></div>
<div class="line"><span class="comment">// of the data.  Note that it does not actually build the tree.</span></div>
<div class="line">DTree&lt;&gt; det(data);</div>
<div class="ttc" id="adtree_8hpp_html"><div class="ttname"><a href="dtree_8hpp.html">dtree.hpp</a></div></div>
<div class="ttc" id="anamespacemlpack_1_1det_html"><div class="ttname"><a href="namespacemlpack_1_1det.html">mlpack::det</a></div><div class="ttdoc">Density Estimation Trees.</div><div class="ttdef"><b>Definition:</b> <a href="dt__utils_8hpp_source.html#l00020">dt_utils.hpp:20</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="dtree_pub_func_det_tut"></a>
Public Functions</h2>
<p>The function <code>Grow()</code> greedily grows the tree, adding new points to the tree. Note that the points in the dataset will be reordered. This should only be run on a tree which has not already been built. In general, it is more useful to use the <code><a class="el" href="namespacemlpack_1_1det.html#a4a84945ed0d2a629c86f8538e6e7090c" title="Train the optimal decision tree using cross-validation with the given number of folds.">Trainer()</a></code> function found in <a class="el" href="dettutorial.html#dtutils_det_tut">'namespace mlpack::det'</a>.</p>
<div class="fragment"><div class="line"><span class="comment">// This keeps track of the data during the shuffle that occurs while growing the</span></div>
<div class="line"><span class="comment">// tree.</span></div>
<div class="line">arma::Col&lt;size_t&gt; oldFromNew(data.n_cols);</div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; data.n_cols; i++)</div>
<div class="line">  oldFromNew[i] = i;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// This function grows the tree down to the leaves. It returns the current</span></div>
<div class="line"><span class="comment">// minimum value of the regularization parameter alpha.</span></div>
<div class="line"><span class="keywordtype">size_t</span> maxLeafSize = 10;</div>
<div class="line"><span class="keywordtype">size_t</span> minLeafSize = 5;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">double</span> <a class="code" href="det_8txt.html#ae7ed598bdef2a989db6a7ae6e7c11288">alpha</a> = det.Grow(data, oldFromNew, <span class="keyword">false</span>, maxLeafSize, minLeafSize);</div>
<div class="ttc" id="adet_8txt_html_ae7ed598bdef2a989db6a7ae6e7c11288"><div class="ttname"><a href="det_8txt.html#ae7ed598bdef2a989db6a7ae6e7c11288">alpha</a></div><div class="ttdeci">see subsection cli_alt_reg_tut Alternate DET regularization The usual regularized error f $R_ alpha(t)\f$ of a node \f $t\f$ is given by</div><div class="ttdef"><b>Definition:</b> <a href="det_8txt_source.html#l00344">det.txt:344</a></div></div>
</div><!-- fragment --><p>Note that the alternate volume regularization should not be used (see ticket #238).</p>
<p>To estimate the density at a given query point, use the following code. Note that the logarithm of the density is returned.</p>
<div class="fragment"><div class="line"><span class="comment">// For a given query, you can obtain the density estimate.</span></div>
<div class="line"><span class="keyword">extern</span> arma::Col&lt;float&gt; query;</div>
<div class="line"><span class="keyword">extern</span> DTree* det;</div>
<div class="line"><span class="keywordtype">double</span> estimate = det-&gt;ComputeValue(&amp;query);</div>
</div><!-- fragment --><p>Computing the <b>variable</b> <b>importance</b> of each feature for the given DET.</p>
<div class="fragment"><div class="line"><span class="comment">// The data matrix and density estimation tree.</span></div>
<div class="line"><span class="keyword">extern</span> arma::mat data;</div>
<div class="line"><span class="keyword">extern</span> DTree* det;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// The variable importances will be saved into this vector.</span></div>
<div class="line">arma::Col&lt;double&gt; varImps;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// You can obtain the variable importance from the current tree.</span></div>
<div class="line">det-&gt;ComputeVariableImportance(varImps);</div>
</div><!-- fragment --><h1><a class="anchor" id="dtutils_det_tut"></a>
'namespace mlpack::det'</h1>
<p>The functions in this namespace allows the user to perform tasks with the 'DTree' class. Most importantly, the <code><a class="el" href="namespacemlpack_1_1det.html#a4a84945ed0d2a629c86f8538e6e7090c" title="Train the optimal decision tree using cross-validation with the given number of folds.">Trainer()</a></code> method allows the full training of a density estimation tree with cross-validation. There are also utility functions which allow printing of leaf membership and variable importance.</p>
<h2><a class="anchor" id="dtutils_util_funcs"></a>
Utility Functions</h2>
<p>The code below details how to train a density estimation tree with cross-validation.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="dt__utils_8hpp.html">mlpack/methods/det/dt_utils.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacemlpack_1_1det.html">mlpack::det</a>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// The dataset matrix, on which to learn the density estimation tree.</span></div>
<div class="line"><span class="keyword">extern</span> arma::Mat&lt;float&gt; data;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// The number of folds for cross-validation.</span></div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">size_t</span> folds = 10; <span class="comment">// Set folds = 0 for LOOCV.</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">size_t</span> maxLeafSize = 10;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">size_t</span> minLeafSize = 5;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Train the density estimation tree with cross-validation.</span></div>
<div class="line">DTree&lt;&gt;* dtree_opt = <a class="code" href="namespacemlpack_1_1det.html#a4a84945ed0d2a629c86f8538e6e7090c">Trainer</a>(data, folds, <span class="keyword">false</span>, maxLeafSize, minLeafSize);</div>
<div class="ttc" id="adt__utils_8hpp_html"><div class="ttname"><a href="dt__utils_8hpp.html">dt_utils.hpp</a></div></div>
<div class="ttc" id="anamespacemlpack_1_1det_html_a4a84945ed0d2a629c86f8538e6e7090c"><div class="ttname"><a href="namespacemlpack_1_1det.html#a4a84945ed0d2a629c86f8538e6e7090c">mlpack::det::Trainer</a></div><div class="ttdeci">DTree&lt; MatType, TagType &gt; * Trainer(MatType &amp;dataset, const size_t folds, const bool useVolumeReg=false, const size_t maxLeafSize=10, const size_t minLeafSize=5, const std::string unprunedTreeOutput=&quot;&quot;, const bool skipPruning=false)</div><div class="ttdoc">Train the optimal decision tree using cross-validation with the given number of folds.</div></div>
</div><!-- fragment --><p>Note that the alternate volume regularization should be set to false because it has known bugs (see #238).</p>
<p>To print the class membership of leaves in the tree into a file, see the following code.</p>
<div class="fragment"><div class="line"><span class="keyword">extern</span> arma::Mat&lt;size_t&gt; labels;</div>
<div class="line"><span class="keyword">extern</span> DTree* det;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">size_t</span> numClasses = 3; <span class="comment">// The number of classes must be known.</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">extern</span> <span class="keywordtype">string</span> leafClassMembershipFile;</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespacemlpack_1_1det.html#a0671a10d605707a02c14efa54a2e16f0">PrintLeafMembership</a>(det, data, labels, numClasses, leafClassMembershipFile);</div>
<div class="ttc" id="anamespacemlpack_1_1det_html_a0671a10d605707a02c14efa54a2e16f0"><div class="ttname"><a href="namespacemlpack_1_1det.html#a0671a10d605707a02c14efa54a2e16f0">mlpack::det::PrintLeafMembership</a></div><div class="ttdeci">void PrintLeafMembership(DTree&lt; MatType, TagType &gt; *dtree, const MatType &amp;data, const arma::Mat&lt; size_t &gt; &amp;labels, const size_t numClasses, const std::string &amp;leafClassMembershipFile=&quot;&quot;)</div><div class="ttdoc">Print the membership of leaves of a density estimation tree given the labels and number of classes.</div></div>
</div><!-- fragment --><p>Note that you can find the number of classes with <code>max(labels)</code> <code>+</code> <code>1</code>. The variable importance can also be printed to a file in a similar manner.</p>
<div class="fragment"><div class="line"><span class="keyword">extern</span> DTree* det;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">extern</span> <span class="keywordtype">string</span> variableImportanceFile;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">size_t</span> numFeatures = data.n_rows;</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespacemlpack_1_1det.html#ac64804c6c73b842b3eb69d9a64fb12e3">PrintVariableImportance</a>(det, numFeatures, variableImportanceFile);</div>
<div class="ttc" id="anamespacemlpack_1_1det_html_ac64804c6c73b842b3eb69d9a64fb12e3"><div class="ttname"><a href="namespacemlpack_1_1det.html#ac64804c6c73b842b3eb69d9a64fb12e3">mlpack::det::PrintVariableImportance</a></div><div class="ttdeci">void PrintVariableImportance(const DTree&lt; MatType, TagType &gt; *dtree, const std::string viFile=&quot;&quot;)</div><div class="ttdoc">Print the variable importance of each dimension of a density estimation tree.</div></div>
</div><!-- fragment --><h1><a class="anchor" id="further_doc_det_tut"></a>
Further Documentation</h1>
<p>For further documentation on the DTree class, consult the <a class="el" href="classmlpack_1_1det_1_1DTree.html">complete API documentation</a>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.9.1
</small></address>
</body>
<script type="text/javascript">
var x = document.querySelectorAll("img.formulaDsp");
var i;
for (i = 0; i < x.length; i++)
{
  x[i].width = x[i].offsetWidth / 4;
}
</script>
</html>
